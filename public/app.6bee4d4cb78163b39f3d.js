!function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){},function(e,t,i){"use strict";i.r(t);i(0);var r=function(e,t,i,r,n){return r+(e-t)/(i-t)*(n-r)},n=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:null};function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,s;return t=e,(i=[{key:"setup",value:function(){var e=this;this.gui=new dat.GUI,this.backgroundColor="#faff06",this.gutter={size:0},this.meshes=[],this.grid={cols:30,rows:30},this.width=window.innerWidth,this.height=window.innerHeight,this.velocity=-.1,this.angle=0,this.amplitude=.1,this.radius=1,this.waveLength=200,this.ripple={},this.interval=0,this.waterDropPositions=[],this.ripples=[],this.gui.addFolder("Background").addColor(this,"backgroundColor").onChange(function(e){document.body.style.backgroundColor=e}),window.addEventListener("resize",this.onResize.bind(this),{passive:!0}),window.addEventListener("visibilitychange",function(t){e.pause=t.target.hidden},!1)}},{key:"createScene",value:function(){this.scene=new THREE.Scene,this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,document.body.appendChild(this.renderer.domElement)}},{key:"createCamera",value:function(){var e=window.innerWidth,t=window.innerHeight;this.camera=new THREE.PerspectiveCamera(10,e/t,1,1e3),this.camera.position.set(-180,180,180),this.scene.add(this.camera)}},{key:"addAmbientLight",value:function(){var e=new THREE.AmbientLight("#fff",1);this.scene.add(e)}},{key:"addSpotLight",value:function(){var e=new THREE.SpotLight("#fff",1);e.position.set(0,50,0),e.castShadow=!0,this.scene.add(e)}},{key:"addPointLight",value:function(e,t){var i=new THREE.PointLight(e,1,1e3,1);i.position.set(t.x,t.y,t.z),this.scene.add(i)}},{key:"createGrid",value:function(){this.groupMesh=new THREE.Object3D;var e={color:"#1643e5",metalness:.3,emissive:"#000000",roughness:1},t=new THREE.MeshPhysicalMaterial(e);this.gui.addFolder("Water").addColor(e,"color").onChange(function(e){t.color=n(e)});for(var i=0;i<this.grid.rows;i++){this.meshes[i]=[];for(var r=0;r<this.grid.cols;r++){var o=new THREE.BoxBufferGeometry(1,1,1),s=this.getMesh(o,t);s.position.y=0,s.name="cube-".concat(i,"-").concat(r);var a=new THREE.Object3D,h=r+r*this.gutter.size,d=i+i*this.gutter.size;a.add(s),a.scale.set(1,1,1),a.position.set(h,0,d),this.meshes[i][r]=a,this.groupMesh.add(a)}}var u=.4*(this.grid.cols+this.grid.cols*this.gutter.size),l=.6*(this.grid.rows+this.grid.rows*this.gutter.size);this.groupMesh.position.set(-u,1,-l),this.scene.add(this.groupMesh);for(var c=0;c<this.grid.rows;c++)for(var p=0;p<this.grid.cols;p++){var f=p+p*this.gutter.size,g=c+c*this.gutter.size;this.waterDropPositions.push({x:f+this.groupMesh.position.x,z:g+this.groupMesh.position.z})}}},{key:"getMesh",value:function(e,t){var i=new THREE.Mesh(e,t);return i.castShadow=!0,i.receiveShadow=!0,i}},{key:"addCameraControls",value:function(){this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement)}},{key:"addFloor",value:function(){var e=new THREE.PlaneGeometry(100,100),t=new THREE.ShadowMaterial({opacity:.3});this.floor=new THREE.Mesh(e,t),this.floor.name="floor",this.floor.position.y=-1,this.floor.rotateX(-Math.PI/2),this.floor.receiveShadow=!0,this.scene.add(this.floor)}},{key:"onResize",value:function(){this.width=window.innerWidth,this.height=window.innerHeight,this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}},{key:"addWaterDrop",value:function(e,t){return new THREE.Mesh(e,t)}},{key:"getRandomWaterDropPosition",value:function(){return this.waterDropPositions[Math.floor(Math.random()*Math.floor(this.waterDropPositions.length))]}},{key:"animateWaterDrops",value:function(){var e=this,t={color:"#6ad2ff",metalness:0,emissive:"#000000",roughness:1},i=new THREE.BoxBufferGeometry(.5,2,.5),r=new THREE.MeshStandardMaterial(t);this.gui.addFolder("Drop").addColor(t,"color").onChange(function(e){r.color=n(e)}),this.interval=setInterval(function(){var t=e.addWaterDrop(i,r),n=e.getRandomWaterDropPosition(),o=n.x,s=n.z;t.position.set(o,50,s),e.scene.add(t),e.pause?(e.scene.remove(t),TweenMax.killAll(!0)):TweenMax.to(t.position,.5,{ease:Sine.easeIn,y:-2,onUpdate:function(){t.position.y<1&&e.ripples.push({x:o,z:s,velocity:-1,angle:0,amplitude:.1,radius:1,motion:-.7})},onComplete:function(){t.position.set(0,50,0),e.scene.remove(t)}})},100)}},{key:"draw",value:function(){for(var e=0;e<this.grid.rows;e++)for(var t=0;t<this.grid.cols;t++)for(var i=0;i<this.ripples.length;i++){var n=this.ripples[i],o=(d=t,u=e,l=n.x-this.groupMesh.position.x,c=n.z-this.groupMesh.position.z,Math.sqrt(Math.pow(d-l,2)+Math.pow(u-c,2)));if(o<n.radius){var s=r(o,0,-this.waveLength,-100,100),a=n.angle+s,h=r(Math.sin(a),-1,0,n.motion>0?0:n.motion,0);this.meshes[e][t].position.y=h}}for(var d,u,l,c,p=0;p<this.ripples.length;p++){var f=this.ripples[p];f.angle-=2*this.velocity,f.radius-=3*this.velocity,f.motion-=this.velocity/5,f.radius>50&&this.ripples.shift()}}},{key:"animate",value:function(){this.controls.update(),this.draw(),this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.animate.bind(this))}},{key:"init",value:function(){this.setup(),this.createScene(),this.createCamera(),this.addAmbientLight(),this.addSpotLight(),this.createGrid(),this.addCameraControls(),this.addFloor(),this.animate(),this.draw(),this.animateWaterDrops()}}])&&o(t.prototype,i),s&&o(t,s),e}())).init()}]);